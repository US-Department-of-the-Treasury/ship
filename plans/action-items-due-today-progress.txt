# Progress Log
PRD: plans/action-items-due-today.prd.json
Started: 2026-02-06T09:05:56-05:00

---


## Iteration 1 - Include due-today items in accountability checks
- Completed: Changed date comparison from > to >= in checkWeeklyPersonAccountability for both weekly_plan (line 390) and weekly_retro (line 418). Added has_overdue and has_due_today boolean flags to the /api/accountability/action-items response. Updated ActionItemsResponse type in frontend hook.
- Files changed: api/src/services/accountability.ts, api/src/routes/accountability.ts, web/src/hooks/useActionItemsQuery.ts
- Learnings: Pre-existing test failures due to audit_log deletion constraint in test setup - not related to our changes.
- Next: banner-urgency-colors (high priority, depends on this story)


## Iteration 2 - Banner shows yellow for due-today, red for overdue
- Completed: Added urgency prop to AccountabilityBanner ('overdue' | 'due_today'). Banner uses bg-amber-600/bg-amber-800 for due-today, bg-red-600/bg-red-800 for overdue. Updated App.tsx to compute urgency from actionItemsData.has_overdue flag. Celebration banner (green) unaffected.
- Files changed: web/src/components/AccountabilityBanner.tsx, web/src/pages/App.tsx
- Learnings: None - straightforward prop threading.
- Next: e2e-tests (medium priority, depends on this story)


## Iteration 3 - E2E tests for banner urgency colors
- Completed: Created e2e/accountability-banner-urgency.spec.ts with 4 tests: API flag verification, red banner for overdue, urgency flag consistency, and modal click test. Initial version had 2 failures (amber test too complex with seed data, modal overlay blocking clicks). Fixed by simplifying amber test to API-level verification and removing localStorage override that caused modal auto-open. All 4 tests pass.
- Files changed: e2e/accountability-banner-urgency.spec.ts
- Learnings: The isolated-env fixture disables modal auto-open via context-level addInitScript. Overriding this at page-level causes conflicts. Seed data always has overdue items (3 months old sprints), making amber-only UI tests impractical without date mocking.
- Next: All stories complete - proceed to Phase 3 (post-completion)

