# Fail on empty Playwright tests (they silently pass - major footgun)
if [ -f "./scripts/check-empty-tests.sh" ]; then
  ./scripts/check-empty-tests.sh
fi

# Check API coverage for new UI routes
if [ -f "./scripts/check-api-coverage.sh" ]; then
  ./scripts/check-api-coverage.sh --staged
fi

# Open source compliance checks (secrets scan + AI analysis)
if command -v comply &> /dev/null; then
  # NOTE: --skip-trivy is temporary workaround for compliance-toolkit bug
  # https://github.com/US-Department-of-the-Treasury/compliance-toolkit/issues/XXX
  # Remove --skip-trivy once the ImportError in sbom module is fixed
  comply opensource --hook --staged --exclude e2e --skip-trivy
else
  echo ""
  echo "WARNING: 'comply' CLI not installed - skipping open source compliance checks"
  echo "Install with: pip install comply-cli"
  echo ""
  echo "This project requires comply for pre-commit security scanning."
  echo "Your commit will proceed, but please install comply for future commits."
  echo ""
fi
